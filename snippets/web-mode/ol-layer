# key: ollayer
# name: ol-layer
# --
<template>
  <div v-if="state.ready && !bare">
    <slot />
  </div>
</template>
<script setup>
// iserver 世界地图
import { inject, onBeforeUnmount, onMounted, reactive } from 'vue'
import { layerCommonOptionsDefinition } from '../config'
import { log } from 'shared-utils'

defineProps({
  ...layerCommonOptionsDefinition,
})

const state = reactive({
  ready: false
})
const map = inject('ol-map')
const projection = inject('ol-projection')

// add
onMounted(() => {
  const layer = new TileLayer({
    source,
    projection,
  })

  provide('layer', layer)
  // provide('source', source)

  map.addLayer(layer)
  log.cb('[`(file-name-nondirectory (buffer-file-name))`] layer added.').end()
})

// remove
onBeforeUnmount(() => {
  map.removeLayer(layer)
  log.cb('[`(file-name-nondirectory (buffer-file-name))`] layer removed.').end()
})
</script>
